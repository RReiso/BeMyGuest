<% provide(:title, 'Contact List') %>
<section>
  <div class="container-fluid">
    <div class="row flex-nowrap">
      <%= render 'events/event_navbar' %>
      <div class="right">
        <% if @contacts.blank? %>
          <p class="text-center mt-5">No existing contacts! </p>
          <p class="text-center">Add some people to <%= link_to "Contacts", user_contacts_path(@user), class:"link-to" %> to be able to add them to the guest list.</p>
        <% else %>
          <%= form_with model: [@current_user, @event, @new_connection], local: true do |f| %>
            <div class="table-responsive contact-table mb-1 mt-5">
              <table class="shadow table table-hover table-light mt-2 table-borderless border border-1 border-warning">
                <thead>
                  <tr>
                    <td colspan="2" class="text-dark border border-warning border-1 text-center p-1 bg-primary">Select guests</td>
                  </tr>
                </thead>
                <tbody>
                  <% @contacts.each do |contact| %>
                    <tr>
                      <td>
                        <%= check_box("contact", "invited", {:multiple => true, class: 'form-check-input check-inv', "data-guest-list"=> in_guest_list?(contact,@event)}, contact.id, nil)%>
                        <label class="pointer" for="contact_invited_<%=contact.id%>" >
                        <%= contact.name %>
                        </label>
                      </td>
                      <td> <%= link_to "Details","#", class: "btn btn-sm btn-outline-secondary", "data-bs-toggle"=>"modal", "data-bs-target"=>"#guestInfoModal-#{contact.id}", "data-bs-whatever"=>"@mdo" %></td>
                      <%= render partial: "connections/guest_info_modal", locals: { guest: contact } %>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
            <div class="d-flex flex-column justify-content-center flex-md-row align-items-center mt-2 mb-5">
            <%= f.submit "Add to guest list", class: "shadow-sm border border-1 border-warning btn btn-primary btn-sm m-1" %>
          <% end %>
          <%= link_to "Back", guests_path(@user,@event), class: "shadow-sm btn btn-sm btn-secondary m-1" %>
            </div>
        <% end %>
      </div>
    </div>
  </div>
</section>